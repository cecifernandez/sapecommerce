<mvc:View
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    controllerName="ui5.starwarsecommerce.controller.ProductDetail"
>
    <core:Fragment
        fragmentName="ui5.starwarsecommerce.fragments.Toolbar"
        type="XML"
    />

    <Page
        showHeader="false"
        class="prod-detail sapUiMediumMarginTop"
    >
        <content>
            <HBox class="sapUiSmallMargin">
                <!-- Imagen del producto -->
                <VBox
                    width="50%"
                    class="sapUiMediumMarginEnd"
                >
                    <Carousel
                        pages="{productDetail>/images}"
                        loop="true"
                        showPageIndicator="true"
                        pageIndicatorPlacement="Bottom"
                    >
                        <Image src="{productDetail>}" />
                    </Carousel>
                </VBox>

                <!-- Detalles del producto -->
                <VBox
                    width="50%"
                    class="sapUiSmallMargin"
                >
                    <Title
                        text="{productDetail>/name}"
                        level="H1"
                    />
                    <Text
                        text="{productDetail>/description}"
                        wrapping="true"
                    />
                    <Title
                        text="Precio: ${productDetail>/price}"
                        level="H2"
                    />
                    <RatingIndicator
                        value="{viewModel>/reviewRating}"
                        maxValue="5"
                        enabled="true"
                        iconSize="2rem"
                        class="sapUiTinyMarginBegin"
                    />
                    <HBox>
                        <Button
                            text="Agregar al carrito"
                            press=".onAddToCart"
                            class="sapUiSmallMarginTop"
                        />
                        <Button
                            icon="{= ${productDetail>/isFavorite} ? 'sap-icon://heart' : 'sap-icon://heart-2'}"
                            type="Transparent"
                            press=".onToggleFavorite"
                            tooltip="Agregar a Favoritos"
                        />
                    </HBox>
                    <Label text="Variante" />
                    <Select
                        items="{productDetail>/variants}"
                        selectedKey="{productDetail>/selectedVariant}"
                        change=".onVariantChange"
                    >
                        <core:Item
                            key="{productDetail>name}"
                            text="{productDetail>name}"
                        />
                    </Select>
                </VBox>
            </HBox>
            <!-- Reseñas del producto -->
            <VBox class="sapUiSmallMarginTop sapUiMediumMarginBegin">
                <Title
                    text="Reseñas"
                    level="H2"
                />
                <List
                    items="{productDetail>/reviews}"
                    class="sapUiResponsiveMargin"
                >
                    <CustomListItem>
                        <VBox class="sapUiSmallMarginBottom">
                            <HBox alignItems="Center">
                                <Title
                                    text="{productDetail>username}"
                                    level="H3"
                                />
                                <RatingIndicator
                                    value="{productDetail>rating}"
                                    maxValue="5"
                                    enabled="false"
                                    iconSize="1rem"
                                    class="sapUiSmallMarginBegin"
                                />
                            </HBox>
                            <Text
                                text="{productDetail>comment}"
                                wrapping="true"
                                class="sapUiTinyMarginTop"
                            />
                        </VBox>
                    </CustomListItem>
                </List>
            </VBox>
            <VBox class="sapUiSmallMarginTop sapUiMediumMarginBegin">
                <Title
                    text="Tus Reseñas"
                    level="H2"
                />
                <List
                    items="{path: 'userModel>/filteredUserReviews'}"
                    class="sapUiResponsiveMargin"
                >
                    <CustomListItem>
                        <VBox class="sapUiSmallMarginBottom">
                            <HBox alignItems="Center">
                                <Title
                                    text="{userModel>user}"
                                    level="H3"
                                />
                                <RatingIndicator
                                    value="{userModel>rating}"
                                    maxValue="5"
                                    enabled="false"
                                    iconSize="1rem"
                                    class="sapUiSmallMarginBegin"
                                />
                            </HBox>
                            <Text
                                text="{userModel>text}"
                                wrapping="true"
                                class="sapUiTinyMarginTop"
                            />
                        </VBox>
                    </CustomListItem>
                </List>
            </VBox>
            <VBox class="sapUiMediumMarginBegin sapUiLargeMarginBottom">
                <Text text="Escribí tu reseña ✍️" />
                <TextArea
                    value="{viewModel>/reviewText}"
                    rows="4"
                    width="100%"
                />
                <Button
                    text="Enviar Reseña"
                    press=".onPostReview"
                />
            </VBox>
        </content>
    </Page>
</mvc:View>
