<mvc:View
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    controllerName="ui5.starwarsecommerce.controller.ProductDetail"
>
    <core:Fragment
        fragmentName="ui5.starwarsecommerce.view.fragments.Toolbar"
        type="XML"
    />

    <Page
        showHeader="false"
        class="prod-detail sapUiMediumMarginTop"
    >
        <content>
            <!-- Imagen del producto -->
            <FlexBox
                class="sapUiSmallMargin productDetailContainer"
                wrap="Wrap"
                direction="Row"
                alignItems="Start"
            >
                <!-- Imagen del producto -->
                <VBox
                    class="productCarouselBox"
                    layoutData="
            sap.ui.layout.FlexItemData: {
                styleClass: 'sapUiResponsiveMargin',
                growFactor: 1
            }
        "
                >
                    <Carousel
                        pages="{productDetail>/images}"
                        loop="true"
                        showPageIndicator="true"
                        pageIndicatorPlacement="Bottom"
                    >
                        <Image src="{productDetail>}" />
                    </Carousel>
                </VBox>

                <!-- Detalles del producto -->
                <VBox class="productDetailsBox sapUiSmallMarginBottom">
                    <Title
                        text="{productDetail>/name}"
                        level="H1"
                    />
                    <Text
                        text="{productDetail>/description}"
                        wrapping="true"
                    />
                    <Title
                        text="{= ${i18n>priceLabel} + ' ' + ${productDetail>/price} }"
                        level="H2"
                    />
                    <RatingIndicator
                        value="{viewModel>/reviewRating}"
                        maxValue="5"
                        enabled="true"
                        iconSize="2rem"
                        class="sapUiTinyMarginBegin"
                    />
                    <HBox
                        alignItems="Center"
                        class="sapUiSmallMarginTop"
                    >
                        <Button
                            text="{i18n>addToCart}"
                            press=".onAddToCart"
                            class="sapUiSmallMarginEnd"
                        />
                        <Button
                            icon="{= ${productDetail>/isFavorite} ? 'sap-icon://heart' : 'sap-icon://heart-2'}"
                            type="Transparent"
                            press=".onToggleFavorite"
                            tooltip="{i18n>addToFavorites}"
                        />
                    </HBox>
                    <Label text="{i18n>variantLabel}" />
                    <Select
                        items="{productDetail>/variants}"
                        selectedKey="{productDetail>/selectedVariant}"
                        change=".onVariantChange"
                    >
                        <core:Item
                            key="{productDetail>name}"
                            text="{productDetail>name}"
                        />
                    </Select>
                </VBox>
            </FlexBox>

            <!-- Reseñas del producto -->
            <VBox class="sapUiSmallMarginTop sapUiMediumMarginBegin">
                <Title
                    text="{i18n>reviews}"
                    level="H2"
                />
                <List
                    items="{productDetail>/reviews}"
                    class="sapUiResponsiveMargin"
                >
                    <CustomListItem>
                        <VBox class="sapUiSmallMarginBottom sapUiTinyMarginTop">
                            <HBox alignItems="Center">
                                <Avatar
                                    src="{productDetail>avatar}"
                                    displaySize="S"
                                    class="sapUiSmallMarginEnd"
                                />
                                <Title
                                    text="{productDetail>username}"
                                    level="H3"
                                />
                                <RatingIndicator
                                    value="{productDetail>rating}"
                                    maxValue="5"
                                    enabled="false"
                                    iconSize="1rem"
                                    class="sapUiSmallMarginBegin"
                                />
                            </HBox>
                            <Text
                                text="{productDetail>comment}"
                                wrapping="true"
                                class="sapUiTinyMarginTop"
                            />
                        </VBox>
                    </CustomListItem>
                </List>
            </VBox>

            <!-- Tus Reseñas -->
            <VBox class="sapUiSmallMarginTop sapUiMediumMarginBegin">
                <Title
                    text="{i18n>yourReviews}"
                    level="H2"
                />
                <List
                    items="{path: 'userModel>/filteredUserReviews'}"
                    class="sapUiResponsiveMargin"
                >
                    <CustomListItem>
                        <VBox class="sapUiSmallMarginBottom sapUiTinyMarginTop">
                            <HBox alignItems="Center">
                                <Avatar
                                    src="{userModel>/avatar}"
                                    displaySize="S"
                                    class="sapUiSmallMarginEnd"
                                />
                                <Title
                                    text="{userModel>user}"
                                    level="H3"
                                />
                                <RatingIndicator
                                    value="{userModel>rating}"
                                    maxValue="5"
                                    enabled="false"
                                    iconSize="1rem"
                                    class="sapUiSmallMarginBegin"
                                />
                            </HBox>
                            <Text
                                text="{userModel>text}"
                                wrapping="true"
                                class="sapUiTinyMarginTop"
                            />
                        </VBox>
                    </CustomListItem>
                </List>
            </VBox>

            <!-- Escribir nueva reseña -->
            <VBox class="sapUiMediumMarginBegin sapUiLargeMarginBottom">
                <Text text="{i18n>writeReview}" />
                <TextArea
                    value="{viewModel>/reviewText}"
                    rows="4"
                    width="100%"
                    placeholder="{i18n>reviewPlaceholder}"
                />
                <Button
                    text="{i18n>submitReview}"
                    press=".onPostReview"
                />
            </VBox>
        </content>
        <footer>
            <core:Fragment
                fragmentName="ui5.starwarsecommerce.view.fragments.Footer"
                type="XML"
            />
        </footer>
    </Page>
</mvc:View>
